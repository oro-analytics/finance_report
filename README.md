# finance_report

## `src/profit_center_analysis.py`

Скрипт собирает P&L и X-charge отчёты для выбранного профит-центра:

1. Ищет файлы `PL_MM YYYY.xlsx` в каталогах за указанные годы и вытаскивает вкладку `pl_projects`.
   * Формирует агрегированную сводку по выручке, прямым и операционным затратам.
   * Отбирает только строки с нужным профит-центром и сохраняет проекты помесячно.
2. Ищет файлы `Secured Rev_Profit centers_MM.xlsx` и собирает X-charge (отдаём/получаем).
3. Генерирует Excel-отчёты с подсветкой появления новых проектов:
   * динамика проектов из `pl_projects` по выбранному профит-центру;
   * X-charge taker/giver отчёты;
   * итоговый сводный файл с агрегированными метриками по месяцам.
4. Финальный отчёт сохраняется с форматированием денежных столбцов и подсказкой по вкладке `Chargeability`.

Параметры (`base_directory`, `years_to_process`, `target_pc`) задаются в начале файла и могут быть изменены под нужный период.
